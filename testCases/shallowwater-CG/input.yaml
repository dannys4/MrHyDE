%YAML 1.1
---
### Based off of example 1 in Samii, J. Sci. Comp. (2019) ###
ANONYMOUS:
  verbosity: 10
  debug level: 0
  profile: false
  Mesh:
    dimension: 2
    element type: quad
    xmin: -1.0
    xmax:  1.0
    ymin: -1.0
    ymax:  1.0
    NX: 40
    NY: 40
  Physics:
    modules: shallow water
    ## define the coarse scale variables
    Initial conditions:
      H: '2. + exp( sin(3.*x)*sin(3.*y) )' 
      Hu: 'cos(-x)'
      Hv: 'sin(y)'

    Dirichlet conditions:
      H:
        all boundaries: '2. + exp( sin(3.*x)*sin(3.*y)-sin(3.*t) )'
      Hu:
        all boundaries: 'cos(4.*t - x)'
      Hv:
        all boundaries: 'sin(4.*t + y)'
  Functions:
    source H: '-3.0*exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y))*cos(3.0*t) + sin(4.0*t - x) + cos(4.0*t + y)'
    source Hu: '(-0.75*(sin(3.0*x)*sin(4.0*t + y)*cos(3.0*y) + sin(3.0*y)*cos(3.0*x)*cos(4.0*t - x))*(exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y)) + 2.0)*exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y))*cos(4.0*t - x) + (0.5*exp(sin(3.0*x)*sin(3.0*y)) + 1.0*exp(sin(3.0*t)))^3*(6.0*exp(-2*sin(3.0*t) + 2*sin(3.0*x)*sin(3.0*y))*sin(3.0*y)*cos(3.0*x) + 12.0*exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y))*sin(3.0*y)*cos(3.0*x) - 8.0*sin(4.0*t - x))*exp(-3*sin(3.0*t)) + (0.5*exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y)) + 1)^2*(2*sin(4.0*t - x) + cos(4.0*t + y))*cos(4.0*t - x))/((0.5*exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y)) + 1)^2*(exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y)) + 2.0))'
    source Hv: '(-0.75*(sin(3.0*x)*sin(4.0*t + y)*cos(3.0*y) + sin(3.0*y)*cos(3.0*x)*cos(4.0*t - x))*(exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y)) + 2.0)*exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y))*sin(4.0*t + y) + (0.5*exp(sin(3.0*x)*sin(3.0*y)) + 1.0*exp(sin(3.0*t)))^3*(6.0*exp(-2*sin(3.0*t) + 2*sin(3.0*x)*sin(3.0*y))*sin(3.0*x)*cos(3.0*y) + 12.0*exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y))*sin(3.0*x)*cos(3.0*y) + 8.0*cos(4.0*t + y))*exp(-3*sin(3.0*t)) + (0.5*exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y)) + 1)^2*(sin(4.0*t - x) + 2*cos(4.0*t + y))*sin(4.0*t + y))/((0.5*exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y)) + 1)^2*(exp(-sin(3.0*t) + sin(3.0*x)*sin(3.0*y)) + 2.0))'
  Discretization:
    order:
      H: 1
      Hu: 1
      Hv: 1
    quadrature: 2
  #Subgrid input file: subgrid_input.yaml
  Solver:
    #solver: steady-state
    #initial type: L2-projection-HFACE
    solver: transient
    workset size: 100
    nonlinear TOL: 1.0e-06
    linear TOL: 1.0e-6
    max nonlinear iters: 10
    max linear iters: 100
    final time: 1.e-1
    delta t: 1e-3
    use direct solver: false
  Analysis: 
    analysis type: forward
  Postprocess: 
    write solution: true
    write subgrid solution: true
    write HFACE variables: true
...
